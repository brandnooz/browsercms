<% @page_title = @toolbar_title = "List #{dynamic_view_type.name.demodulize.titleize.pluralize}" %>
<%= content_for(:html_head) do %>
  <%= javascript_tag do %>
    jQuery(function($){
      $('table.data tbody tr').hover(function(){
        $(this).addClass('hover')
      }, function(){
        $(this).removeClass('hover')
      }).click(function(){
        var match = this.id.match(/(.*)_(\d+)/) 
        var type = match[1];
        var id = match[2];
        $('table.data tbody tr').removeClass('selected');
        $(this).addClass('selected');
        $('#edit_button').removeClass('disabled').attr('href', '/cms/<%= dynamic_view_type.name.demodulize.underscore.pluralize %>/'+id+'/edit');
        $('#delete_button').removeClass('disabled').attr('href', '/cms/<%= dynamic_view_type.name.demodulize.underscore.pluralize %>/'+id)
      })
    })
  <% end %>
<% end %>

<%= content_for :functions do %>
  <div class="btn-toolbar">
    <%= add_button cms_new_path_for(dynamic_view_type) %>
    <%= edit_button %>
    <%= delete_button :title => "Are you sure you want to delete this #{dynamic_view_type.name.demodulize.underscore.titleize}?" %>
  </div>
<% end %>

<table class="data table table-condensed table-hover" style="margin-top: 40px;">
  <thead>
  <tr>
    <th>Name</th>
    <th>Updated At</th>
  </tr>
  </thead>
  <tbody>
  <% @views.each do |view| %>
    <tr id="<%= dynamic_view_type.form_name %>_<%= view.id %>">
      <td title="<%= view.file_path %>"><%= view.display_name %></td>
      <td><%= view.updated_at && view.updated_at.to_s(:date) %></td>
    </tr>
  <% end %>
  </tbody>
</table>

<% if @views.size == 0 && params[:key_word]%>
  <div class="alert alert-info">
    No results found for '<%= params[:key_word] %>'
  </div>  
<% elsif @views.total_pages > 1 %>
  <%= render_pagination @views, dynamic_view_type %>
<% end %>

